<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>PRO버전</title>
	<style>
		html{background-color: #26262b;color: #fff;}
		a{text-decoration: none;color: #03a9f4}
	    #btn{
	    	text-align: center;
	        border: 1px solid #1A73E8;
	        background-color: #1A73E8;
	        color: #fff;
	        border-radius: 5px;
	        padding: 5px 30px;
	        cursor: pointer;
	        margin-top: 40px;
	    }
	    #btn:hover{
	        border: 1px solid #0464b1;
	        background-color: #0464b1;
	    }
	    #ri{text-align: right;}
	</style>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xeicon@2.3.3/xeicon.min.css">
</head>
<body>
	<div style="text-align: center;">
		<h2><i class="xi-twich" style="color: #9370db;font-size: 1.2em;"></i> Twitch Server Checker</h2>
		<h4>구입 페이지 <a href="./desk.html" target="_blank">구입 문의</a></h4>
	</div>
	<div style="text-align: center;margin-top: 50px;">
		<h4>PRO 기능 추가 : 서버를 자동으로 한국서버로 잡아줍니다.</h4>
	</div>
	<div style="text-align: center;margin-top: 50px;" id="main">
		<table style="margin: auto;" cellpadding="10">
			<tr>
				<td id="ri">크롬 스토어 이메일 주소</td>
				<td style="text-align: left;"><input type="text" name="mail" id="gid" style="background-color: #26262b;color: #fff;border: 1px solid #eee;"> @gmail.com</td>
				<td style="text-align: right;"><a href="./WebstoreEmail.html" target="_blank">확인 방법</a></td>
			</tr>
			<tr>
				<td colspan="3" style="text-align: right; color: #ff8686;font-size: 0.8em;padding-top: 0px;">
					<p style="margin-top: 0px;">정확하게 써주세요. 크롬에 다른 아이디로 접속시 이 프로그램을 다운받으실 수 없습니다.</p>
				</td>
			</tr>
			<tr>
				<td id="ri">입금하실 계좌</td>
				<td style="text-align: left;" colspan="2">국민) 937702-00-298660 , 예금주 : 허재혁</td>
			</tr>
			<tr>
				<td id="ri">입금하실 금액</td>
				<td style="text-align: left;">5500 원</td>
				<td></td>
			</tr>
			<tr>
				<td id="ri">입금자 성명 (받는사람 표시내용)</td>
				<td style="text-align: left;"><input type="text" name="name" id="Sname" style="background-color: #26262b;color: #fff;border: 1px solid #eee;"></td>
				<td style="text-align: right;"><a href="./bankname.html" target="_blank">확인 방법</a></td>
			</tr>
			<tr>
				<td colspan="3" style="text-align: right; color: #ff8686;font-size: 0.8em;padding-top: 0px;">
					<p style="margin-top: 0px;">서버에서 입금자명으로 확인을 합니다. 정확하게 써주세요.</p>
				</td>
			</tr>
			<tr><td colspan="3" style="text-align: center;">&nbsp;</td></tr>
			<tr style="margin-top: 20px;">
				<td colspan="3" style="text-align: left; color: #ffa8a8;">
					<p>입금 완료 버튼은 입금 완료후 눌러주셔야됩니다 ! !</p><br>
					<p>확인은 서버에서 은행서버와 통신하며 최대 30초가 소요될수 있습니다.</p>
					<p>하루에 3회 연속 실패 제한이 있으며 이후에는 고객센터로 문의하셔야됩니다.</p>
				</td>
			</tr>
			<tr><td colspan="3" style="text-align: center;">&nbsp;</td></tr>
			<tr>
				<td colspan="3" style="text-align: center;user-select: none;" id="finish"><span id="btn" onclick="Conf();">입금 완료</span></td>
			</tr>
		</table>
	</div>
	<script>
		//header("Access-Control-Allow-Origin: hi098123.github.io");
		(function GetTime(){
			var xhr = new XMLHttpRequest();
		    xhr.open("GET" , "https://www.encryptedsni.com/cdn-cgi/trace" , true);
		    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
		    xhr.onreadystatechange = function() {
		        if(xhr.readyState == 4 && xhr.status == 200)
		        {
		            var arr=xhr.responseText.split('\n');
		            var DataARR=[];
		            for (var i = 0; i < arr.length; i++) {
		            	var tmp=arr[i].split("=");
		            	DataARR[tmp[0]]=tmp[1];
		            }
		            //DataARR[arr]
		            //console.log(DataARR['ts']);
		            var date = new Date(DataARR['ts']*1000);
					// Hours part from the timestamp
					var hours = date.getHours();
					// Minutes part from the timestamp
					var endDate   = new Date("04/09/2013 23:30:00");
					var timeGap = new Date(0, 0, 0, 0, 0, 0, date-endDate);
					var diffHour = timeGap.getHours();
					var diffMin  = timeGap.getMinutes();
					if(diffHour==0 && diffMin<35){
						//페이지 이용 불가표시
		            	console.log("지원 가능시간이 아닙니다.");
		            	DGEID("main").innerHTML="<h2>은행점검시간 등의 이유로 이용 가능시간이 아닙니다.</h2><h2>매일 23:30 ~ 00:05 에는 이용하실 수 없습니다.</h2>";
					}
		        }
		    }
		    xhr.send();
		})();
		function Conf(){
			if(confirm('입금을 하셨나요?\n\n아직 입금전 이면 취소를 눌러주세요.')){
				//xhr과 확인작업,처리중임을 안내
				DGEID("finish").innerHTML="<h3>서버와 통신중입니다.</h3>";
				var xhr3 = new XMLHttpRequest();
				var params = "b=kb"+"&name="+DGEID('Sname').value+"&id="+DGEID('gid').value+"&grade=ce";
			    xhr3.open("POST" , "https://leddown.iptime.org/bank/index.php" , true);
			    xhr3.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
			    xhr3.onreadystatechange = function() {
			        if(xhr3.readyState == 4 && xhr3.status == 200)
			        {
			            if(xhr3.responseText=='1'){
			            	alert("결제에 성공하였습니다.");
			            	document.location.href="./invite.html";
			            }else if(xhr3.responseText=='0'){
			            	alert("결제에 실패하였습니다.");
			            	document.location.href="./index.html";
			            }else if(xhr3.responseText=='3'){
			            	alert("결제에 실패하였습니다.\n\n결제금액이 다르거나 입금자명이 다릅니다.");
			            	document.location.href="./index.html";
			            }else if(xhr3.responseText=='4'){
			            	alert("오늘 시도수가 많습니다. 관리자에게 문의주세요.");
			            	document.location.href="./index.html";
			            }else{
			            	alert("알수없는 응답 신호. 관리자에게 문의주세요.");
			            	document.location.href="./index.html";
			            }
			        }
			    }
			    xhr3.send(params);
			}
		}
		function DGEID(arg) {
			return document.getElementById(arg);
		}
	</script>
</body>
</html>